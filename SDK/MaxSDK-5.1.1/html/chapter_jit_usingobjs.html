<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<title>Max5 API Reference</title>
		<link href="c74-doxygen.css" rel="stylesheet" type="text/css">
	</head>
	<body>

		<div id="c74header">
			<img src="max5.png" />
			<p>Max 5 API Reference</p>
		</div>

<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="chapter_jit_usingobjs">Using Jitter Objects in C </a></h1><p>When developing for Jitter in C, the functionality of pre-existing Jitter objects can be used.</p>
<p>In this chapter, we'll briefly examine instantation and incorporation of the features of the jit.qt.movie and jit.qt.record objects from your C code.</p>
<h2><a class="anchor" id="chapter_jit_usingobjs_ex1">
Example 1: the t_jit_qt_movie object</a></h2>
<p>Using an object like t_jit_qt_movie from your own code is fairly straightforward. Since it's a standard Jitter object, we can use <a class="el" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new()</a> and <a class="el" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free()</a> for instantiation and freeing, <a class="el" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method()</a> for sending messages, and jit_attr_get... and jit_attr_set... for getting and setting attributes.</p>
<p>For instance, in the following code snippet, we'll create a t_jit_qt_movie object, read a pre-specified movie from disk, and decompress its first frame into a matrix, set to the native size of the movie.</p>
<div class="fragment"><pre class="fragment"><span class="keywordtype">void</span> jit_foo_read_first_movie_frame(
   t_jit_foo *x, <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *s, <span class="keywordtype">long</span> ac, <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> *av)
{
   <span class="keywordtype">void</span> *qtmovie;
   
   <span class="comment">// create the t_jit_qt_movie object, sized to 1x1</span>
   qtmovie = <a class="code" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new</a>(<a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;jit_qt_movie&quot;</span>), 1, 1);
   <span class="keywordflow">if</span> (qtmovie) {
      <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> rv; <span class="comment">// will contain rvarr, with any return values </span>
                 <span class="comment">// from our &quot;read&quot; call</span>
      <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or...">t_object</a> *rvarr; <span class="comment">// the t_atomarray with the actual </span>
                       <span class="comment">// return values</span>

      <span class="comment">// turn off autostart</span>
      <a class="code" href="group__attrmod.html#ga610b248e58c4026a004e73a6748715ca" title="Sets attribute value as a long integer value.">jit_attr_setlong</a>(qtmovie, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;autostart&quot;</span>), 0); 
      <span class="comment">// read the movie, just pass in the args to our function</span>
      <a class="code" href="group__obj.html#ga443dee482af22e0fe83e68955d367226" title="Sends a type-checked message to an object.">object_method_typed</a>(qtmovie, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;read&quot;</span>), ac, av, &amp;rv);
      
      <span class="comment">// check the return value &amp; verify that the movie loaded</span>
      <span class="keywordflow">if</span> (rvarr = <a class="code" href="group__atommod.html#ga84dda6fa7e1e2f29e897c1d87a06ba8e" title="Retrieves atom value as object pointer.">jit_atom_getobj</a>(&amp;rv)) {
         <span class="keywordtype">long</span> rvac = 0;
         <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> *rvav = NULL;
         
         <a class="code" href="group__obj.html#gab033973cea2f4a0b17bb48ab2f22f051" title="Retrieves the value of an object which supports the getvalueof/setvalueof interface...">object_getvalueof</a>(rvarr, &amp;rvac, &amp;rvav);
         <span class="keywordflow">if</span> (rvac &amp;&amp; rvav) {
            <span class="comment">// just as in Max, we get a list: &quot;filename success&quot;;</span>
            <span class="comment">// success of 1 means the read was successful</span>
            <span class="keywordflow">if</span> (rvac &gt; 1 &amp;&amp; <a class="code" href="group__atommod.html#gaf63b5b3ffc46134bed05adf071a7d52a" title="Retrieves atom value as long integer.">jit_atom_getlong</a>(rvav + 1)) {               
               <span class="keywordtype">long</span> dim[2];
               <span class="keywordtype">void</span> *matrix;
               <a class="code" href="structt__jit__matrix__info.html" title="Matrix information struct.">t_jit_matrix_info</a> info;

               <span class="comment">// get our movie&apos;s native dims</span>
               <a class="code" href="group__attrmod.html#gae0183a2a3b6e01c510982ca459d81042" title="Retrieves attribute value as an array of long integer values.">jit_attr_getlong_array</a>(qtmovie, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;movie_dim&quot;</span>),
                  2, dim);
               <span class="comment">// set the t_jit_qt_movie&apos;s dim to match</span>
               <a class="code" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method</a>(qtmovie,_jit_sym_dim,dim[0],dim[1]);
               <span class="comment">// set our matrix up to match</span>
               <a class="code" href="group__matrixmod.html#ga9c068d7781425345e99576a1955366af" title="Initializes matrix info struct to default values.">jit_matrix_info_default</a>(&amp;info);
               info.<a class="code" href="structt__jit__matrix__info.html#a37a2ef0a44ee55587b56b2fea63ef217" title="primitifve type (char, long, float32, or float64)">type</a> = _jit_sym_char;
               info.<a class="code" href="structt__jit__matrix__info.html#a4f8e32123477684b18c83ca3d9079803" title="number of planes">planecount</a> = 4;
               info.<a class="code" href="structt__jit__matrix__info.html#a51f55844070b10955b23235f6ef68d1c" title="number of dimensions">dimcount</a> = 2;
               info.<a class="code" href="structt__jit__matrix__info.html#a500e46ec5cc4182111fb01931968c6d4" title="dimension sizes">dim</a>[0] = dim[0];
               info.<a class="code" href="structt__jit__matrix__info.html#a500e46ec5cc4182111fb01931968c6d4" title="dimension sizes">dim</a>[1] = dim[1];
               matrix = <a class="code" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new</a>(_jit_sym_jit_matrix, &amp;info);
               <span class="keywordflow">if</span> (matrix) {
                  <span class="comment">// call the t_jit_qt_movie&apos;s matrix_calc method </span>
                  <span class="comment">// with our matrix as an argument</span>
                  err = (t_jit_err)<a class="code" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method</a>(qtmovie,
                     _jit_sym_matrix_calc, NULL, matrix);
                  <span class="keywordflow">if</span> (err != JIT_ERR_NONE) {
                     <a class="code" href="group__console.html#gaa7733e30b2951f225e24dca1ed4632b2" title="Print an error to the Max window.">error</a>(<span class="stringliteral">&quot;something went wrong&quot;</span>);
                  }
                  <span class="comment">// do something with the matrix</span>
                  
                  <span class="comment">// free the matrix</span>
                  <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free</a>(matrix);
               }
            }
            <a class="code" href="group__memory.html#gaa1dc485c42515917ca377dbaf15b7dcd" title="Free memory allocated with getbytes().">freebytes</a>(rvav, <span class="keyword">sizeof</span>(<a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a>) * rvac);
         }
         <a class="code" href="group__class__old.html#gadf30646e52376a37b93cc20efac65636" title="Release the memory used by a Max object.">freeobject</a>(rvarr);
      }
      <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free</a>(qtmovie);
   }
}
</pre></div><p>Naturally, we could also set the t_jit_qt_movie object's time attribute, or call its or frame method, to recall an arbitrary point in time. In fact, nearly every documented method and attribute of the jit.qt.movie object, as it functions in the Max interface, is available from C. The exceptions are those functions implemented in the Max wrapper object, such as framedump. </p>
</div>
		<div id="c74footer">
			<p>Copyright &copy; 2008, <a href="http://www.cycling74.com/">Cycling '74</a></p>
		</div>
	</body>
</html>
