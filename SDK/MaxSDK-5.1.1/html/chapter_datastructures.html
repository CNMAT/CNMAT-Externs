<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<title>Max5 API Reference</title>
		<link href="c74-doxygen.css" rel="stylesheet" type="text/css">
	</head>
	<body>

		<div id="c74header">
			<img src="max5.png" />
			<p>Max 5 API Reference</p>
		</div>

<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="chapter_datastructures">Data Structures </a></h1><h2><a class="anchor" id="chapter_datastructures_linkedlists">
Linked Lists</a></h2>
<p>The Max <a class="el" href="structt__linklist.html" title="The linklist object.">t_linklist</a> data structure is useful for maintaining ordered lists of items where you want to be able to insert and delete items efficiently. Random access of individual items, however, gets appreciably slower as the list grows in size. The <a class="el" href="structt__linklist.html" title="The linklist object.">t_linklist</a> is thread-safe by default, but thread safety can be turned off for performance benefits in single-threaded applications. However, ensure that your use of the linked list is truly single-threaded (based on an understanding of Max's <a class="el" href="chapter_threading.html">Threading</a> model) before turning off the thread safety features.</p>
<p>By default, the <a class="el" href="structt__linklist.html" title="The linklist object.">t_linklist</a> holds pointers to Max objects. However, you can treat what the linklist holds as data rather than objects to be freed by using the <a class="el" href="group__linklist.html#gacb89cb9e0a3b6c8e631dd00734643cdb" title="Set the linklist&#39;s datastore flags.">linklist_flags()</a> function.</p>
<p>Here is a simple example of the use of <a class="el" href="structt__linklist.html" title="The linklist object.">t_linklist</a>. The code below stores five symbols, sorts them, searches for a specific item, deletes an item, prints all items, and then frees the entire structure. Since symbols in Max are never freed, <a class="el" href="group__linklist.html#gacb89cb9e0a3b6c8e631dd00734643cdb" title="Set the linklist&#39;s datastore flags.">linklist_flags()</a> is used to specify that data, rather than object pointers, are being stored.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> mylistfun()
    {
    <a class="code" href="structt__linklist.html" title="The linklist object.">t_linklist</a> *list;

    list = (<a class="code" href="structt__linklist.html" title="The linklist object.">t_linklist</a> *)<a class="code" href="group__linklist.html#ga62dba349046e7f84cf34c9c80f04d44a" title="Create a new linklist object.">linklist_new</a>();

    <a class="code" href="group__linklist.html#gacb89cb9e0a3b6c8e631dd00734643cdb" title="Set the linklist&amp;#39;s datastore flags.">linklist_flags</a>(list, <a class="code" href="group__datastore.html#ggaa858d4b3815076d79624c39d9ca59348a862748073762ebc9f5899a8c1d63053a" title="don&amp;#39;t free data or call method">OBJ_FLAG_DATA</a>);

    <span class="comment">// add some data</span>
    <a class="code" href="group__linklist.html#ga7360ba45714cb28e2b4cd44aa8998a67" title="Add an item to the end of the list.">linklist_append</a>(list, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;one&quot;</span>));
    <a class="code" href="group__linklist.html#ga7360ba45714cb28e2b4cd44aa8998a67" title="Add an item to the end of the list.">linklist_append</a>(list, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;two&quot;</span>));
    <a class="code" href="group__linklist.html#ga7360ba45714cb28e2b4cd44aa8998a67" title="Add an item to the end of the list.">linklist_append</a>(list, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;three&quot;</span>));
    <a class="code" href="group__linklist.html#ga7360ba45714cb28e2b4cd44aa8998a67" title="Add an item to the end of the list.">linklist_append</a>(list, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;four&quot;</span>));
    <a class="code" href="group__linklist.html#ga7360ba45714cb28e2b4cd44aa8998a67" title="Add an item to the end of the list.">linklist_append</a>(list, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;five&quot;</span>));

    <span class="comment">// sort</span>

    <a class="code" href="group__linklist.html#gaf01b5f67a8ceccdd75cff34f6ecdd8c2" title="Sort the linked list.">linklist_sort</a>(list, (<a class="code" href="group__datastore.html#gaaf4ae6dd800a2be9abd645cf70aeb38f" title="Comparison function pointer type.">t_cmpfn</a>)mysortfun);

    <span class="comment">// search</span>

    index = <a class="code" href="group__linklist.html#gab7f3c26cb704c460892818b89a1ab004" title="Search the linked list for the first item meeting defined criteria.">linklist_findfirst</a>(list, &amp;found, mysearchfun, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;four&quot;</span>));  <span class="comment">// find the &quot;four&quot; symbol</span>

    <span class="keywordflow">if</span> (index != -1)    <span class="comment">// found</span>
        <a class="code" href="group__linklist.html#gaa89cf5b917b41ad0c15963dd79800b50" title="Remove the item from the list at the specified index.">linklist_chuckindex</a>(list, index);

    <span class="comment">// iterate</span>

    <a class="code" href="group__linklist.html#ga6f4496ef6dc1d6d121acf25d7cd5f946" title="Call the specified function for every item in the linklist.">linklist_funall</a>(list, myprintfun, NULL);

    <span class="comment">// delete</span>

    <a class="code" href="group__linklist.html#ga033f4bf2a9f806e168697b5ce0f6331e" title="Free a linklist, but don&amp;#39;t free the items it contains.">linklist_chuck</a>(list);

    }
</pre></div><p>The sorting function compares two items in the list and returns non-zero if the first one should go before the second one.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">long</span> mysortfun(<span class="keywordtype">void</span> *a, <span class="keywordtype">void</span> *b)
    {
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *sa = (<a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *)a;
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *sb = (<a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *)b;

        <span class="keywordflow">return</span> strcmp(sa-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>, sb-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>) &gt; 0;
    }
</pre></div><p>The search function is passed the final argument to <a class="el" href="group__linklist.html#gab7f3c26cb704c460892818b89a1ab004" title="Search the linked list for the first item meeting defined criteria.">linklist_findfirst()</a> and, in this case, just returns the symbol that matches, which is just testing for pointer equivalence since all Max symbols are unique. You could do more sophisticated searching if you store more complex data in a linklist.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">long</span> mysearchfun(<a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *elem, <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *match)
    {
        <span class="keywordflow">return</span> elem == match;
    }
</pre></div><p>The iteration function takes some action on all items in the list. The third argument to <a class="el" href="group__linklist.html#ga6f4496ef6dc1d6d121acf25d7cd5f946" title="Call the specified function for every item in the linklist.">linklist_funall()</a> is passed as the second argument to your iteration function. In this example, we don't do anything with it.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> myprintfun(<a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *item, <span class="keywordtype">void</span> *dummy)
    {
        <a class="code" href="group__console.html#ga3714108f42b44384b4d58009eafc1806" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;%s&quot;</span>,item-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>);
    }
</pre></div><p>There are many more functions for operating on linked lists you can read about by exploring the <a class="el" href="group__linklist.html">Linked List</a> function reference.</p>
<h2><a class="anchor" id="chapter_datastructures_hashtabs">
Hash Tables</a></h2>
<p>A hash table is a data structure that associates some data with a unique key. If you know the key, you can get back the data much more quickly than with a linked list, particularly as the number of items stored grows larger. The Max hash table <a class="el" href="structt__hashtab.html" title="The hashtab object.">t_hashtab</a> is optimized to work with symbol pointers as keys, but you can use any pointer or number, as long as it is unique.</p>
<p>To create a <a class="el" href="structt__hashtab.html" title="The hashtab object.">t_hashtab</a>, you use <a class="el" href="group__hashtab.html#ga70be9bbfb9bd9383824df0832477267f" title="Create a new hashtab object.">hashtab_new()</a>. To add items, use <a class="el" href="group__hashtab.html#gaa26ebe9ba21e84dd0dbb8d5aed12e5a1" title="Store an item in a hashtab with an associated key.">hashtab_store()</a>. To find items that have been added, use <a class="el" href="group__hashtab.html#gadb206ea811204926bdbf1aa00ca679dc" title="Return an item stored in a hashtab with the specified key.">hashtab_lookup()</a>.</p>
<p>By contrast with linked lists and arrays, hash tables do not have a strong sense of ordering. You can iterate through all items using <a class="el" href="group__hashtab.html#ga37e7b5c20c9fc69e9435f788f35335dc" title="Call the specified function for every item in the hashtab.">hashtab_funall()</a>, but the exact order is not under your control as items are added and removed. There is also no way to "sort" a hash table.</p>
<p>Example:</p>
<p>The following example creates a hashtab, shows how to add some data (in this case, just a number), look it up, and delete the hashtab. </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="structt__hashtab.html" title="The hashtab object.">t_hashtab</a> *tab = (<a class="code" href="structt__hashtab.html" title="The hashtab object.">t_hashtab</a> *)<a class="code" href="group__hashtab.html#ga70be9bbfb9bd9383824df0832477267f" title="Create a new hashtab object.">hashtab_new</a>(0);
    <span class="keywordtype">long</span> result, value;

    <a class="code" href="group__hashtab.html#gaa26ebe9ba21e84dd0dbb8d5aed12e5a1" title="Store an item in a hashtab with an associated key.">hashtab_store</a>(tab, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;a great number&quot;</span>), (<a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or...">t_object</a> *)74);

    result = <a class="code" href="group__hashtab.html#gadb206ea811204926bdbf1aa00ca679dc" title="Return an item stored in a hashtab with the specified key.">hashtab_lookup</a>(tab, <a class="code" href="group__symbol.html#ga8268797d125a15bae1010af70b559e05" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating...">gensym</a>(<span class="stringliteral">&quot;a great number&quot;</span>), (<a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or...">t_object</a> **)value);

    <span class="keywordflow">if</span> (!result)
        <a class="code" href="group__console.html#ga3714108f42b44384b4d58009eafc1806" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;found the value and it is %ld&quot;</span>,value);
    <span class="keywordflow">else</span>
        <a class="code" href="group__console.html#ga3714108f42b44384b4d58009eafc1806" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;did not find the value&quot;</span>);

    <a class="code" href="group__hashtab.html#gac3203c76c8321cde39088beab8b4d2e8" title="Free a hashtab, but don&amp;#39;t free the items it contains.">hashtab_chuck</a>(tab);
</pre></div><p>Note that the Max <a class="el" href="structt__dictionary.html" title="The dictionary object.">t_dictionary</a> used for managing patcher data is implemented as a <a class="el" href="structt__hashtab.html" title="The hashtab object.">t_hashtab</a>. </p>
</div>
		<div id="c74footer">
			<p>Copyright &copy; 2008, <a href="http://www.cycling74.com/">Cycling '74</a></p>
		</div>
	</body>
</html>
