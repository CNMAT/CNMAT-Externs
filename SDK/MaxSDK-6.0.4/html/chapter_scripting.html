<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Max 6 API</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
	<div id="c74header">
		<img src="header.png" height="200" />
	</div>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('chapter_scripting.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Scripting the Patcher </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Your object can use scripting capabilities of the patcher to learn things about its context, such as the patcher's name, hierarchy, or the peer objects to your object in its patcher.</p>
<p>You can also modify a patcher, although any actions your object takes are not undoable and may not work in the runtime version.</p>
<h2><a class="anchor" id="chapter_scripting_knowing"></a>
Knowing the Patcher</h2>
<p>To obtain the patcher object containing your object, you can use the obex hash table. The obex (for "object extensions") is, more generally, a way to store and recall data in your object. In this case, however, we are just using it in a read-only fashion.</p>
<p>Note that unlike the technique discussed in previous versions of the SDK, using the obex to find the patcher works at any time, not just in the new instance routine.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> myobject_getmypatcher(t_myobject *x)
    {
        <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *mypatcher;

        <a class="code" href="group__obj.html#gaba3a848eba4f4b834c1f89377c75e281" title="Retrieves the value of a data stored in the obex.">object_obex_lookup</a>(x, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;#P&quot;</span>), &amp;mypatcher);
        <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;my patcher is at address %lx&quot;</span>,mypatcher);
    }
</pre></div><p>The patcher is an opaque Max object. To access data in a patcher, you'll use attributes and methods.</p>
<h3><a class="anchor" id="chapter_scripting_knowing_name"></a>
Patcher Name and File Path</h3>
<p>To obtain the name of the patcher and its file path (if any), obtain attribute values as shown below. </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *name = <a class="code" href="group__attr.html#ga001b1ff245bf22db3fadabd61324d1e7" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getsym</a>(patcher, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;name&quot;</span>));
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *path = <a class="code" href="group__attr.html#ga001b1ff245bf22db3fadabd61324d1e7" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getsym</a>(patcher, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;filepath&quot;</span>));
</pre></div><p>These attributes may return NULL or empty symbols.</p>
<h3><a class="anchor" id="chapter_scripting_knowing_heirarchy"></a>
Patcher Hierarchy</h3>
<p>To determine the patcher hierarchy above the patcher containing your object, you can use jpatcher_getparentpatcher(). A patcher whose parent is NULL is a top-level patcher. Here is a loop that prints the name of each parent patcher as you ascend the hierarchy.</p>
<div class="fragment"><pre class="fragment">        <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *parent, *patcher;
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *name;

        <a class="code" href="group__obj.html#gaba3a848eba4f4b834c1f89377c75e281" title="Retrieves the value of a data stored in the obex.">object_obex_lookup</a>(x, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;#P&quot;</span>), &amp;patcher);
        parent = patcher;
        <span class="keywordflow">do</span> {
            parent = jpatcher_getparentpatcher(parent);
            <span class="keywordflow">if</span> (parent) {
                name = <a class="code" href="group__attr.html#ga001b1ff245bf22db3fadabd61324d1e7" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getsym</a>(parent, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;name&quot;</span>));
                <span class="keywordflow">if</span> (name)
                    <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;%s&quot;</span>,name-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>)
            }
        } <span class="keywordflow">while</span> (parent != NULL);
</pre></div><h3><a class="anchor" id="chapter_scripting_knowing_objects"></a>
Getting Objects in a Patcher</h3>
<p>To obtain the first object in a patcher, you can use <a class="el" href="group__jpatcher.html#gafd77f63d504807973a4ce400c304b174" title="Get the first box in a patcher.">jpatcher_get_firstobject()</a>. Subsequent objects are available with <a class="el" href="group__jbox.html#ga89177ab12d45649c7209e65c97a3b128" title="The next box in the patcher&#39;s (linked) list of boxes.">jbox_get_nextobject()</a>.</p>
<p>If you haven't read the <a class="el" href="chapter_ui_anatomy.html">Anatomy of a UI Object</a>, we'll mention that the patcher does not keep a list of non-UI objects directly. Instead it keeps a list of UI objects called boxes, and the box that holds non-UI objects is called a newobj. The "objects" you obtain with calls such as <a class="el" href="group__jpatcher.html#gafd77f63d504807973a4ce400c304b174" title="Get the first box in a patcher.">jpatcher_get_firstobject()</a> are boxes. The <a class="el" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object()</a> routine can be used to get the pointer to the actual object, whether the box is a UI object or a newobj containing a non-UI object. In the case of UI objects such as dials and sliders, the pointer returned by <a class="el" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object()</a> will be the same as the box. But for non-UI objects, it will be different.</p>
<p>Here is a function that prints the class of every object (in a box) in a patcher containing an object. </p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> myobject_printpeers(t_myobject *x)
    {
        <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *patcher, *box, *obj;

        <a class="code" href="group__obj.html#gaba3a848eba4f4b834c1f89377c75e281" title="Retrieves the value of a data stored in the obex.">object_obex_lookup</a>(x, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;#P&quot;</span>), &amp;patcher);

        <span class="keywordflow">for</span> (box = <a class="code" href="group__jpatcher.html#gafd77f63d504807973a4ce400c304b174" title="Get the first box in a patcher.">jpatcher_get_firstobject</a>(patcher); box; box = <a class="code" href="group__jbox.html#ga89177ab12d45649c7209e65c97a3b128" title="The next box in the patcher&#39;s (linked) list of boxes.">jbox_get_nextobject</a>(box)) {
            obj = <a class="code" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object</a>(box);
            <span class="keywordflow">if</span> (obj)
                <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="group__obj.html#gac4523e68b4be4deb6db0ea91948d3553" title="Retrieves an object instance&#39;s class name.">object_classname</a>(obj)-&gt;s_name);
            <span class="keywordflow">else</span>
                <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;box with NULL object&quot;</span>);
        }
    }
</pre></div><h3><a class="anchor" id="chapter_scripting_knowing_iteration"></a>
Iteration Using Callbacks</h3>
<p>As an alternative to the technique shown above, you can write a callback function for use with the patcher's iteration service. The advantage of using iteration is that you can descend into the patcher hierarchy without needing to know the details of the various objects that may contain subpatchers (patcher, poly~, bpatcher, etc.). If you want to iterate only at one level of a patcher hierarchy, you can do that too.</p>
<p>Your iteration function is defined as follows. It will be called on every box in a patcher (and, if you specify, the patcher's subpatchers). </p>
<div class="fragment"><pre class="fragment">     <span class="keywordtype">long</span> myobject_iterator(t_myobject *x, <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *b);
</pre></div><p>The function returns 0 if iteration should continue, or 1 if it should stop. This permits you to use an iterator as a way to search for a specific object.</p>
<p>Here is an example of using an iterator function:</p>
<div class="fragment"><pre class="fragment">        <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *patcher;
        <span class="keywordtype">long</span> result = 0;
        <a class="code" href="group__datatypes.html#ga73edaae82b318855cc09fac994918165" title="A Max error code.">t_max_err</a> err;

        err = <a class="code" href="group__obj.html#gaba3a848eba4f4b834c1f89377c75e281" title="Retrieves the value of a data stored in the obex.">object_obex_lookup</a>(x, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;#P&quot;</span>), &amp;patcher);

        <a class="code" href="group__obj.html#gae740749094827ac5adc2b7145db1c596" title="Sends an untyped message to an object.">object_method</a>(patcher, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;iterate&quot;</span>), myobject_iterator, (<span class="keywordtype">void</span> *)x, <a class="code" href="group__patcher.html#ggabc6126af1d45847bc59afa0aa3216b04a128de369dd62c2625aff042d820456eb" title="instead, of b-&gt;b_firstin, pass b to function, whether or not b-&gt;b_firstin is NULL">PI_WANTBOX</a> | <a class="code" href="group__patcher.html#ggabc6126af1d45847bc59afa0aa3216b04a615ccc19640c4714e619315b94765e48" title="descend into subpatchers (not used by audio library)">PI_DEEP</a>, &amp;result);
</pre></div><p>The <a class="el" href="group__patcher.html#ggabc6126af1d45847bc59afa0aa3216b04a128de369dd62c2625aff042d820456eb" title="instead, of b-&gt;b_firstin, pass b to function, whether or not b-&gt;b_firstin is NULL">PI_WANTBOX</a> flag tells the patcher iterator that it should pass your iterator function the box, rather than the object contained in the box. The <a class="el" href="group__patcher.html#ggabc6126af1d45847bc59afa0aa3216b04a615ccc19640c4714e619315b94765e48" title="descend into subpatchers (not used by audio library)">PI_DEEP</a> flag means that the iteration will descend, depth first, into subpatchers. The result parameter returns the last value returned by the iterator. For example, if the iterator terminates early by returning a non-zero value, it will contain that value. If the iterator function does not terminate early, result will be 0.</p>
<p>Assuming the iterator function receives boxes, here is an example iterator that prints out the class and scripting name (if any) of all of the objects in a patcher. Note that the scripting name is an attribute of the box, while the class we would like to know is of the object associated with the box.</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">long</span> myobject_iterator(t_myobject *x, <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *b)
    {
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *name = <a class="code" href="group__attr.html#ga001b1ff245bf22db3fadabd61324d1e7" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getsym</a>(b, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;varname&quot;</span>));
        <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *cls = <a class="code" href="group__obj.html#gac4523e68b4be4deb6db0ea91948d3553" title="Retrieves an object instance&#39;s class name.">object_classname</a>(<a class="code" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object</a>(b));

        <span class="keywordflow">if</span> (name)
            <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;%s (%s)&quot;</span>,cls-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>, name-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>);
        <span class="keywordflow">else</span>
            <a class="code" href="group__console.html#ga8eebb1400d598f4423f925102d02970a" title="Print text to the Max window.">post</a>(<span class="stringliteral">&quot;%s&quot;</span>, cls-&gt;<a class="code" href="structt__symbol.html#ae2bf70cea045897c171f39116bf536c8" title="name: a c-string">s_name</a>);
        <span class="keywordflow">return</span> 0;
    }
</pre></div><h2><a class="anchor" id="chapter_scripting_objects"></a>
Creating Objects</h2>
<p>Much of the Max user interface is implemented using patcher scripting. For example, the inspectors are patchers in which an inspector object has been created. The file browser window has four or five separate scripted objects in it. Even the debug window is a dynamically scripted patcher. We point this out just to inform you that creating objects in a patcher actually works (if you get all the details right). The xxx example object shows how to use patcher scripting to create an "editing window" similar to the ones you see when double-clicking on a table or buffer~ object.</p>
<p>Creating objects in a patcher generally requires the use of a <a class="el" href="group__dictionary.html">Dictionary</a> (see discussion of UI objects above), but there is a convenience function <a class="el" href="group__obj.html#gaa7fbd3be9a16b2abf1e5a27fec9cff74" title="Create a new object in a specified patcher with values using a combination of attribute and sprintf s...">newobject_sprintf()</a> that can be used to avoid some of the complexity.</p>
<p>To create an object, your task is to set some attributes. In the absence of any specific values, an object's attributes will be set to some default, but you'll probably care, at the very least, about specifying the object's location. Here is an example that creates a toggle and metro object using a combination of attribute parse syntax and sprintf. If you're interested in creating objects with <a class="el" href="group__obj.html#gaa7fbd3be9a16b2abf1e5a27fec9cff74" title="Create a new object in a specified patcher with values using a combination of attribute and sprintf s...">newobject_sprintf()</a>, it may help to examine a Max document to see some of the attribute name - value pairs used to specify objects.</p>
<div class="fragment"><pre class="fragment">        <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *patcher, *toggle, *metro;
        <a class="code" href="group__datatypes.html#ga73edaae82b318855cc09fac994918165" title="A Max error code.">t_max_err</a> err;

        err = <a class="code" href="group__obj.html#gaba3a848eba4f4b834c1f89377c75e281" title="Retrieves the value of a data stored in the obex.">object_obex_lookup</a>(x, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;#P&quot;</span>), &amp;patcher);

        toggle = <a class="code" href="group__obj.html#gaa7fbd3be9a16b2abf1e5a27fec9cff74" title="Create a new object in a specified patcher with values using a combination of attribute and sprintf s...">newobject_sprintf</a>(patcher, <span class="stringliteral">&quot;@maxclass toggle </span>
<span class="stringliteral">            @patching_position %.2f %.2f&quot;</span>,
            x-&gt;togxpos, x-&gt; togxpos);

        metro = <a class="code" href="group__obj.html#gaa7fbd3be9a16b2abf1e5a27fec9cff74" title="Create a new object in a specified patcher with values using a combination of attribute and sprintf s...">newobject_sprintf</a>(patcher, <span class="stringliteral">&quot;@maxclass newobj @text \&quot;metro 400\&quot; </span>
<span class="stringliteral">            @patching_position %.2f %.2f&quot;</span>,
            x-&gt;metxpos, x-&gt;metypos);
</pre></div><p>Note that to create a non-UI object, you use set the maxclass attribute to newobj and the text attribute to the contents of the object box. Attributes can be specified in any order. Using the patching_position attribute permits you to specify only the top-left corner and use the object's default size. For text objects, the default size is based on the default font for the patcher.</p>
<p>Finally, note that <a class="el" href="group__obj.html#gaa7fbd3be9a16b2abf1e5a27fec9cff74" title="Create a new object in a specified patcher with values using a combination of attribute and sprintf s...">newobject_sprintf()</a> returns a pointer to the newly created box, not the newly created object inside the box. To get the object inside the box, use <a class="el" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object()</a>.</p>
<h3><a class="anchor" id="chapter_scripting_objects_connecting"></a>
Connecting Objects</h3>
<p>If you'd like to script the connections between two objects, you can do so via a message to the patcher. Assuming you have the patcher, toggle, and metro objects above, you'll create an array of atoms to send the message using <a class="el" href="group__obj.html#ga443dee482af22e0fe83e68955d367226" title="Sends a type-checked message to an object.">object_method_typed()</a>.</p>
<div class="fragment"><pre class="fragment">        <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> msg[4], rv;

        <a class="code" href="group__atom.html#ga0ad7d5c696047effee6b6bbf04a981c4" title="Inserts a generic pointer value into a t_atom and change the t_atom&#39;s type to A_OBJ.">atom_setobj</a>(msg, toggle);       <span class="comment">// source</span>
        <a class="code" href="group__atom.html#ga98af493b18dfac0f8d441e16e520d5f6" title="Inserts an integer into a t_atom and change the t_atom&#39;s type to A_LONG.">atom_setlong</a>(msg + 1, 0);       <span class="comment">// outlet number (0 is leftmost)</span>
        <a class="code" href="group__atom.html#ga0ad7d5c696047effee6b6bbf04a981c4" title="Inserts a generic pointer value into a t_atom and change the t_atom&#39;s type to A_OBJ.">atom_setobj</a>(msg + 2, metro);    <span class="comment">// destination</span>
        <a class="code" href="group__atom.html#ga98af493b18dfac0f8d441e16e520d5f6" title="Inserts an integer into a t_atom and change the t_atom&#39;s type to A_LONG.">atom_setlong</a>(msg + 3, 0);       <span class="comment">// inlet number (0 is leftmost)</span>

        <a class="code" href="group__obj.html#ga443dee482af22e0fe83e68955d367226" title="Sends a type-checked message to an object.">object_method_typed</a>(patcher, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;connect&quot;</span>), 4, msg, &amp;rv);
</pre></div><p>If you want to have a hidden connection, pass an optional fifth argument that is any negative number.</p>
<h2><a class="anchor" id="chapter_scripting_objects_deleting"></a>
Deleting Objects</h2>
<p>To delete an object in a patcher you call <a class="el" href="group__obj.html#ga3759846cb356195532c41e35b87522ee" title="Call the free function and release the memory for an instance of an internal object class previously ...">object_free()</a> on the box. As of Max 5.0.6 this will properly redraw the patcher and remove any connected patch cords.</p>
<h2><a class="anchor" id="chapter_scripting_attrs"></a>
Obtaining and Changing Patcher and Object Attributes</h2>
<p>You can use object attribute functions to modify the appearance and behavior of objects in a patcher or the patcher itself. Note that only a few of these attributes can be modified by the user. The C level access to attributes is much more extensive.</p>
<p>Attributes whose type is object can be accessed via object_attr_getobj() / object_attr_setobj(). Attributes whose type is char can be accessed with object_attr_getchar() / object_attr_setchar(). Attributes whose type is long can be accessed with <a class="el" href="group__attr.html#ga1179c4e91fb8263447ff4dfa471df953" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getlong()</a> / <a class="el" href="group__attr.html#ga986dd931f91666f178bdf3aace48f53b" title="Sets the value of an attribute, given its parent object and name.">object_attr_setlong()</a>. Attributes whose type is symbol can be accessed via <a class="el" href="group__attr.html#ga001b1ff245bf22db3fadabd61324d1e7" title="Retrieves the value of an attribute, given its parent object and name.">object_attr_getsym()</a> / <a class="el" href="group__attr.html#ga642c3b5686b08880194f74c0d5149bcf" title="Sets the value of an attribute, given its parent object and name.">object_attr_setsym()</a>. For attributes that are arrays, such as colors and rectangles, use object_attr_getvalueof() / <a class="el" href="group__attr.html#ga95163d72f6b7500e5986af0f23743e4f" title="Sets the value of an object&#39;s attribute.">object_attr_setvalueof()</a>.</p>
<h3><a class="anchor" id="chapter_scripting_attrs_patcher"></a>
Patcher Attributes</h3>
<table class="doxtable">
<tr>
<td>Name </td><td>Type </td><td>Settable </td><td>Description </td></tr>
<tr>
<td>box </td><td>object </td><td>No </td><td>The box containing the patcher (NULL for top-level patcher)  </td></tr>
<tr>
<td>locked </td><td>char </td><td>Yes (not in runtime) </td><td>Locked state of the patcher  </td></tr>
<tr>
<td>presentation </td><td>char </td><td>Yes </td><td>Presentation mode of the patcher  </td></tr>
<tr>
<td>openinpresentation </td><td>char </td><td>Yes </td><td>Will patcher open in presentation mode?  </td></tr>
<tr>
<td>count </td><td>long </td><td>No </td><td>Number of objects in a patcher  </td></tr>
<tr>
<td>fgcount </td><td>long </td><td>No </td><td>Number of objects in the patcher's foreground layer  </td></tr>
<tr>
<td>bgcount </td><td>long </td><td>No </td><td>Number of objects in the patcher's background layer  </td></tr>
<tr>
<td>numvews </td><td>long </td><td>No </td><td>Number of currently open views of the patcher  </td></tr>
<tr>
<td>numwindowviews </td><td>long </td><td>No </td><td>Number of currently open window-based views of the patcher  </td></tr>
<tr>
<td>firstobject </td><td>object </td><td>No </td><td>First box in the patcher  </td></tr>
<tr>
<td>lastobject </td><td>object </td><td>No </td><td>Last box in the patcher  </td></tr>
<tr>
<td>firstline </td><td>object </td><td>No </td><td>First patch cord in the patcher  </td></tr>
<tr>
<td>firstview </td><td>object </td><td>No </td><td>First view object in the patcher  </td></tr>
<tr>
<td>title </td><td>symbol </td><td>Yes </td><td>Window title  </td></tr>
<tr>
<td>fulltitle </td><td>symbol </td><td>No </td><td>Complete title including "unlocked" etc.  </td></tr>
<tr>
<td>name </td><td>symbol </td><td>No </td><td>Name (could be different from title)  </td></tr>
<tr>
<td>filename </td><td>symbol </td><td>No </td><td>Filename  </td></tr>
<tr>
<td>filepath </td><td>symbol </td><td>No </td><td>File path (platform-independent file path syntax)  </td></tr>
<tr>
<td>fileversion </td><td>long </td><td>No </td><td>File version  </td></tr>
<tr>
<td>noedit </td><td>char </td><td>No </td><td>Whether patcher can be unlocked  </td></tr>
<tr>
<td>collective </td><td>object </td><td>No </td><td>Collective object, if patcher is inside a collective  </td></tr>
<tr>
<td>cansave </td><td>char </td><td>No </td><td>Whether patcher can be saved  </td></tr>
<tr>
<td>dirty </td><td>char </td><td>Yes (not in runtime) </td><td>Whether patcher is modified  </td></tr>
<tr>
<td>bglocked </td><td>char </td><td>Yes </td><td>Whether background is locked  </td></tr>
<tr>
<td>rect </td><td>double[4] </td><td>Yes </td><td>Patcher's rect (left, top, width, height)  </td></tr>
<tr>
<td>defrect </td><td>double[4] </td><td>Yes </td><td>Patcher's default rect (used when opening the first view)  </td></tr>
<tr>
<td>openrect </td><td>double[4] </td><td>Yes </td><td>Fixed initial window location  </td></tr>
<tr>
<td>parentpatcher </td><td>object </td><td>No </td><td>Immediate parent patcher (NULL for toplevel patchers)  </td></tr>
<tr>
<td>toppatcher </td><td>object </td><td>No </td><td>Topmost parent patcher (NULL for toplevel patchers)  </td></tr>
<tr>
<td>parentclass </td><td>object </td><td>No </td><td>Class object of parent (patcher, poly~, bpatcher etc.)  </td></tr>
<tr>
<td>bgcolor </td><td>double[4] </td><td>Yes </td><td>Locked background color (RGBA)  </td></tr>
<tr>
<td>editing_bgcolor </td><td>double[4] </td><td>Yes </td><td>Unlocked background color (RGBA)  </td></tr>
<tr>
<td>edit_framecolor </td><td>double[4] </td><td>Yes </td><td>Text editing frame color  </td></tr>
<tr>
<td>locked_iocolor </td><td>double[4] </td><td>Yes </td><td>Locked inlet/outlet color  </td></tr>
<tr>
<td>unlocked_iocolor </td><td>double[4] </td><td>Yes </td><td>Unlocked inlet/outlet color  </td></tr>
<tr>
<td>boguscolor </td><td>double[4] </td><td>Yes </td><td>Color of uninitialized (bogus) objects  </td></tr>
<tr>
<td>gridsize </td><td>double[2] </td><td>Yes </td><td>Editing grid size  </td></tr>
<tr>
<td>gridonopen </td><td>char </td><td>Yes </td><td>Show grid on open  </td></tr>
<tr>
<td>gridsnapopen </td><td>char </td><td>Yes </td><td>Snap to grid on open  </td></tr>
<tr>
<td>imprint </td><td>char </td><td>Yes </td><td>Save default-valued object attributes  </td></tr>
<tr>
<td>defaultfocusbox </td><td>symbol </td><td>Yes </td><td>Default focus box (varname)  </td></tr>
<tr>
<td>enablehscroll </td><td>char </td><td>Yes </td><td>Show horizontal scrollbar  </td></tr>
<tr>
<td>enablevscroll </td><td>char </td><td>Yes </td><td>Show vertical scrollbar  </td></tr>
<tr>
<td>boxanimatetime </td><td>long </td><td>Yes </td><td>Box animation time  </td></tr>
<tr>
<td>default_fontname </td><td>symbol </td><td>Yes </td><td>Default font name  </td></tr>
<tr>
<td>default_fontface </td><td>long </td><td>Yes </td><td>Default "fake" font face (0 plain, 1, bold, 2 italic, 3 bold italic)  </td></tr>
<tr>
<td>default_fontsize </td><td>long </td><td>Yes </td><td>Default font size in points  </td></tr>
<tr>
<td>toolbarvisible </td><td>char </td><td>Yes </td><td>Show toolbar on open  </td></tr>
<tr>
<td>toolbarheight </td><td>long </td><td>Yes </td><td>Height of toolbar (can use 0 for invisible)  </td></tr>
<tr>
<td>toolbarid </td><td>symbol </td><td>Yes </td><td>Name (in maxinterface.json) of toolbar, none = empty symbol  </td></tr>
</table>
<h3><a class="anchor" id="chapter_scripting_attrs_box"></a>
Box Attributes</h3>
<table class="doxtable">
<tr>
<td>Name </td><td>Type </td><td>Settable </td><td>Description </td></tr>
<tr>
<td>rect </td><td>double[4] </td><td>Settable only </td><td>Changes both patching_rect and presentation_rect  </td></tr>
<tr>
<td>presentation_rect </td><td>double[4] </td><td>Yes </td><td>Presentation mode rect  </td></tr>
<tr>
<td>patching_rect </td><td>double[4] </td><td>Yes </td><td>Patching mode rect  </td></tr>
<tr>
<td>position </td><td>double[2] </td><td>Settable only </td><td>Changes both patching_position and presentation_position  </td></tr>
<tr>
<td>size </td><td>double[2] </td><td>Settable only </td><td>Changes both patching_size and presentation_size  </td></tr>
<tr>
<td>patching_position </td><td>double[2] </td><td>Yes </td><td>Patching mode position (top, left corner)  </td></tr>
<tr>
<td>presentation_position</td><td>d[2] </td><td>Yes </td><td>Presentation mode position  </td></tr>
<tr>
<td>patching_size </td><td>double[2] </td><td>Yes </td><td>Patching mode size (width, height)  </td></tr>
<tr>
<td>presentation_size </td><td>double[2] </td><td>Yes </td><td>Presentation mode size  </td></tr>
<tr>
<td>maxclass </td><td>symbol </td><td>No </td><td>Name of Max class (newobj for non-UI objects)  </td></tr>
<tr>
<td>object </td><td>object </td><td>No </td><td>Associated object (equivalent to jbox_get_object)  </td></tr>
<tr>
<td>patcher </td><td>object </td><td>No </td><td>Containing patcher  </td></tr>
<tr>
<td>hidden </td><td>char </td><td>Yes </td><td>Is box hidden on lock?  </td></tr>
<tr>
<td>fontname </td><td>symbol </td><td>Yes </td><td>Font name (if box has font attributes or a text field)  </td></tr>
<tr>
<td>fontface </td><td>long </td><td>Yes </td><td>"Fake" font face (if box has font attribute or a text field)  </td></tr>
<tr>
<td>fontsize </td><td>long </td><td>Yes </td><td>Font size (if box has font attributes or a text field)  </td></tr>
<tr>
<td>textcolor </td><td>double[4] </td><td>Yes </td><td>Text color (if box has font attributes or a text field)  </td></tr>
<tr>
<td>hint </td><td>symbol </td><td>Yes </td><td>Associated hint  </td></tr>
<tr>
<td>color </td><td>double[4] </td><td>Yes </td><td>Standard color attribute (may not be present in all objects)  </td></tr>
<tr>
<td>nextobject </td><td>object </td><td>No </td><td>Next object in the patcher's list  </td></tr>
<tr>
<td>prevobject </td><td>object </td><td>No </td><td>Previous object in the patcher's list  </td></tr>
<tr>
<td>varname </td><td>symbol </td><td>Yes </td><td>Scripting name  </td></tr>
<tr>
<td>id </td><td>symbol </td><td>No </td><td>Immutable object ID (stored in files)  </td></tr>
<tr>
<td>canhilite </td><td>char </td><td>No </td><td>Does this object accept focus?  </td></tr>
<tr>
<td>background </td><td>char </td><td>Yes </td><td>Include in background  </td></tr>
<tr>
<td>ignoreclick </td><td>char </td><td>Yes </td><td>Ignores clicks  </td></tr>
<tr>
<td>maxfilename </td><td>symbol </td><td>No </td><td>Filename if class is external  </td></tr>
<tr>
<td>description </td><td>symbol </td><td>No </td><td>Description used by assistance  </td></tr>
<tr>
<td>drawfirstin </td><td>char </td><td>No </td><td>Is leftmost inlet drawn?  </td></tr>
<tr>
<td>growy </td><td>char </td><td>No </td><td>Can object grow with fixed aspect ratio?  </td></tr>
<tr>
<td>growboth </td><td>char </td><td>No </td><td>Can object grow independently in width and height?  </td></tr>
<tr>
<td>nogrow </td><td>char </td><td>No </td><td>Is object fixed size?  </td></tr>
<tr>
<td>mousedragdelta </td><td>char </td><td>No </td><td>Does object use hidden-mouse drag tracking (number box)  </td></tr>
<tr>
<td>textfield </td><td>object </td><td>No </td><td>Textfield object associated with this box if any  </td></tr>
<tr>
<td>editactive </td><td>char </td><td>No </td><td>Is object the currently focused box in an unlocked patcher?  </td></tr>
<tr>
<td>prototypename </td><td>symbol </td><td>No </td><td>Name of the prototype file used to create this object  </td></tr>
<tr>
<td>presentation </td><td>char </td><td>Yes </td><td>Is object included in the presentation?  </td></tr>
<tr>
<td>annotation </td><td>symbol </td><td>Yes </td><td>Text shown in clue window when mouse is over the object  </td></tr>
<tr>
<td>numinlets </td><td>long </td><td>No </td><td>Number of inlets visible  </td></tr>
<tr>
<td>numoutlets </td><td>long </td><td>No </td><td>Number of outlets visible  </td></tr>
<tr>
<td>outlettype </td><td>symbol[] </td><td>No </td><td>Array of symbols with outlet types ("signal" etc.)  </td></tr>
</table>
<p>To access an attribute of a non-UI object, use <a class="el" href="group__jbox.html#ga5063d165cfca9dc76162ff5757ea4852" title="Retrieve a pointer to the box&#39;s object.">jbox_get_object()</a> on the box to obtain the non-UI object first. </p>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

		<div id="c74footer">
			&nbsp;&nbsp;Copyright &copy; 2011, <a href="http://www.cycling74.com/">Cycling '74</a>
		</div>
	</body>
</html>
