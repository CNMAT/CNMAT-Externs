<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Max 6 API</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
	<div id="c74header">
		<img src="header.png" height="200" />
	</div>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('chapter_jit_usingobjs.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Using Jitter Objects in C </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>When developing for Jitter in C, the functionality of pre-existing Jitter objects can be used.</p>
<p>In this chapter, we'll briefly examine instantation and incorporation of the features of the jit.qt.movie and jit.qt.record objects from your C code.</p>
<h2><a class="anchor" id="chapter_jit_usingobjs_ex1"></a>
Example 1: the t_jit_qt_movie object</h2>
<p>Using an object like t_jit_qt_movie from your own code is fairly straightforward. Since it's a standard Jitter object, we can use <a class="el" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new()</a> and <a class="el" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free()</a> for instantiation and freeing, <a class="el" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method()</a> for sending messages, and jit_attr_get... and jit_attr_set... for getting and setting attributes.</p>
<p>For instance, in the following code snippet, we'll create a t_jit_qt_movie object, read a pre-specified movie from disk, and decompress its first frame into a matrix, set to the native size of the movie.</p>
<div class="fragment"><pre class="fragment"><span class="keywordtype">void</span> jit_foo_read_first_movie_frame(
   t_jit_foo *x, <a class="code" href="structt__symbol.html" title="The symbol.">t_symbol</a> *s, <span class="keywordtype">long</span> ac, <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> *av)
{
   <span class="keywordtype">void</span> *qtmovie;
   
   <span class="comment">// create the t_jit_qt_movie object, sized to 1x1</span>
   qtmovie = <a class="code" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new</a>(<a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;jit_qt_movie&quot;</span>), 1, 1);
   <span class="keywordflow">if</span> (qtmovie) {
      <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> rv; <span class="comment">// will contain rvarr, with any return values </span>
                 <span class="comment">// from our &quot;read&quot; call</span>
      <a class="code" href="structt__object.html" title="The structure for the head of any object which wants to have inlets or outlets, or support attributes...">t_object</a> *rvarr; <span class="comment">// the t_atomarray with the actual </span>
                       <span class="comment">// return values</span>

      <span class="comment">// turn off autostart</span>
      <a class="code" href="group__attrmod.html#ga610b248e58c4026a004e73a6748715ca" title="Sets attribute value as a long integer value.">jit_attr_setlong</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;autostart&quot;</span>), 0); 
      <span class="comment">// read the movie, just pass in the args to our function</span>
      <a class="code" href="group__obj.html#ga443dee482af22e0fe83e68955d367226" title="Sends a type-checked message to an object.">object_method_typed</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;read&quot;</span>), ac, av, &amp;rv);
      
      <span class="comment">// check the return value &amp; verify that the movie loaded</span>
      <span class="keywordflow">if</span> (rvarr = <a class="code" href="group__atommod.html#ga84dda6fa7e1e2f29e897c1d87a06ba8e" title="Retrieves atom value as object pointer.">jit_atom_getobj</a>(&amp;rv)) {
         <span class="keywordtype">long</span> rvac = 0;
         <a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a> *rvav = NULL;
         
         <a class="code" href="group__obj.html#gab033973cea2f4a0b17bb48ab2f22f051" title="Retrieves the value of an object which supports the getvalueof/setvalueof interface.">object_getvalueof</a>(rvarr, &amp;rvac, &amp;rvav);
         <span class="keywordflow">if</span> (rvac &amp;&amp; rvav) {
            <span class="comment">// just as in Max, we get a list: &quot;filename success&quot;;</span>
            <span class="comment">// success of 1 means the read was successful</span>
            <span class="keywordflow">if</span> (rvac &gt; 1 &amp;&amp; <a class="code" href="group__atommod.html#gaf63b5b3ffc46134bed05adf071a7d52a" title="Retrieves atom value as long integer.">jit_atom_getlong</a>(rvav + 1)) {               
               <span class="keywordtype">long</span> dim[2];
               <span class="keywordtype">void</span> *matrix;
               <a class="code" href="structt__jit__matrix__info.html" title="Matrix information struct.">t_jit_matrix_info</a> info;

               <span class="comment">// get our movie&#39;s native dims</span>
               <a class="code" href="group__attrmod.html#gae0183a2a3b6e01c510982ca459d81042" title="Retrieves attribute value as an array of long integer values.">jit_attr_getlong_array</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb" title="Given a C-string, fetch the matching t_symbol pointer from the symbol table, generating the symbol if...">gensym</a>(<span class="stringliteral">&quot;movie_dim&quot;</span>),
                  2, dim);
               <span class="comment">// set the t_jit_qt_movie&#39;s dim to match</span>
               <a class="code" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method</a>(qtmovie,<a class="code" href="group__jitter.html#gae59203825989a640817bad4d5b0961dd" title="cached t_symbol">_jit_sym_dim</a>,dim[0],dim[1]);
               <span class="comment">// set our matrix up to match</span>
               <a class="code" href="group__matrixmod.html#ga9c068d7781425345e99576a1955366af" title="Initializes matrix info struct to default values.">jit_matrix_info_default</a>(&amp;info);
               info.<a class="code" href="structt__jit__matrix__info.html#a37a2ef0a44ee55587b56b2fea63ef217" title="primitifve type (char, long, float32, or float64)">type</a> = <a class="code" href="group__jitter.html#ga3a06cf8d41c4f4c017c0bf825fec59f8" title="cached t_symbol">_jit_sym_char</a>;
               info.<a class="code" href="structt__jit__matrix__info.html#a4f8e32123477684b18c83ca3d9079803" title="number of planes">planecount</a> = 4;
               info.<a class="code" href="structt__jit__matrix__info.html#a51f55844070b10955b23235f6ef68d1c" title="number of dimensions">dimcount</a> = 2;
               info.<a class="code" href="structt__jit__matrix__info.html#a500e46ec5cc4182111fb01931968c6d4" title="dimension sizes">dim</a>[0] = dim[0];
               info.<a class="code" href="structt__jit__matrix__info.html#a500e46ec5cc4182111fb01931968c6d4" title="dimension sizes">dim</a>[1] = dim[1];
               matrix = <a class="code" href="group__objectmod.html#gabde2eb49750992ec4125af862b402342" title="Instantiates an object specified by class name.">jit_object_new</a>(<a class="code" href="group__jitter.html#ga8f405e5881e1e61c374ee50a0b65316e" title="cached t_symbol">_jit_sym_jit_matrix</a>, &amp;info);
               <span class="keywordflow">if</span> (matrix) {
                  <span class="comment">// call the t_jit_qt_movie&#39;s matrix_calc method </span>
                  <span class="comment">// with our matrix as an argument</span>
                  err = (t_jit_err)<a class="code" href="group__objectmod.html#ga9e1b9b8ed4fce611de26a74c6e1452c8" title="Calls an object method specified by method name.">jit_object_method</a>(qtmovie,
                     <a class="code" href="group__jitter.html#ga3dde1a04b3c379fdebae36d532924b13" title="cached t_symbol">_jit_sym_matrix_calc</a>, NULL, matrix);
                  <span class="keywordflow">if</span> (err != JIT_ERR_NONE) {
                     <a class="code" href="group__console.html#ga8a87d2e25431900a88722759ec115757" title="Print an error to the Max window.">error</a>(<span class="stringliteral">&quot;something went wrong&quot;</span>);
                  }
                  <span class="comment">// do something with the matrix</span>
                  
                  <span class="comment">// free the matrix</span>
                  <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free</a>(matrix);
               }
            }
            <a class="code" href="group__memory.html#gaa1dc485c42515917ca377dbaf15b7dcd" title="Free memory allocated with getbytes().">freebytes</a>(rvav, <span class="keyword">sizeof</span>(<a class="code" href="structt__atom.html" title="An atom is a typed datum.">t_atom</a>) * rvac);
         }
         <a class="code" href="group__class__old.html#gadf30646e52376a37b93cc20efac65636" title="Release the memory used by a Max object.">freeobject</a>(rvarr);
      }
      <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object.">jit_object_free</a>(qtmovie);
   }
}
</pre></div><p>Naturally, we could also set the t_jit_qt_movie object's time attribute, or call its or frame method, to recall an arbitrary point in time. In fact, nearly every documented method and attribute of the jit.qt.movie object, as it functions in the Max interface, is available from C. The exceptions are those functions implemented in the Max wrapper object, such as framedump. </p>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

		<div id="c74footer">
			&nbsp;&nbsp;Copyright &copy; 2011, <a href="http://www.cycling74.com/">Cycling '74</a>
		</div>
	</body>
</html>
